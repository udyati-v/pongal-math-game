<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Pongal Math Harvest</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  font-family:Segoe UI, sans-serif;
  background:linear-gradient(135deg,#f7c873,#f4a261);
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
}
.card{
  background:#fff3e0;
  width:92%;
  max-width:500px;
  padding:22px;
  border-radius:16px;
  box-shadow:0 12px 30px rgba(0,0,0,0.25);
}
h1,h2{text-align:center}
.subtitle{text-align:center;font-weight:600;margin-bottom:14px}
.question{white-space:pre-line;line-height:1.5;margin:10px 0}
input,button{
  width:100%;
  padding:12px;
  margin-top:10px;
  font-size:16px;
  border-radius:10px;
}
button{border:none;cursor:pointer}
.submit{background:#2ecc71;color:white}
.skip{background:#e67e22;color:white}
.info{display:flex;justify-content:space-between;margin-top:12px;font-weight:bold}
.hidden{display:none}
</style>
</head>

<body>

<div class="card" id="startScreen">
  <h1>üåæ Pongal Math Harvest ‚òÄÔ∏è</h1>
  <p class="subtitle">
    Beat the clock! ‚è∞Ô∏è Solve more,‚ûóÔ∏è score moreüíØ ‚Äî top 3 wins rewards!‚ú®Ô∏è
  </p>
  <input id="playerName" placeholder="Enter your name">
  <button class="submit" onclick="startGame()">Start Game</button>
</div>

<div class="card hidden" id="gameScreen">
  <h2 id="qNo"></h2>
  <div id="introText"></div>
  <div class="question" id="questionText"></div>

  <input id="answerInput" placeholder="Type your answer">
  <button class="submit" onclick="submitAnswer()">Submit</button>
  <button class="skip hidden" id="skipBtn" onclick="skipQuestion()">Skip</button>

  <div class="info">
    <div>‚è≥ Time: <span id="time"></span></div>
    <div>‚≠ê Score: <span id="score">0</span></div>
  </div>
</div>

<div class="card hidden" id="endScreen">
  <h2>Game Over üéâ</h2>
  <p style="text-align:center;font-size:18px">
    Final Score: <b><span id="finalScore"></span></b>
  </p>
  <p style="text-align:center;font-size:14px">
    You have completed the game. Replay is not allowed on this device.
  </p>
</div>

<script>
/* ---------- BLOCK REPLAY AFTER COMPLETION ---------- */
if (localStorage.getItem("pongal_completed")) {
  document.body.innerHTML = `
    <h2 style="text-align:center;margin-top:40px">
      ‚ùå You have already completed this game on this device.
    </h2>`;
}

/* ---------- TIME FORMAT ---------- */
function formatTime(t){
  const m=Math.floor(t/60);
  const s=t%60;
  return `${m}:${s<10?"0"+s:s}`;
}

/* ---------- GAME STATE ---------- */
let time=150;
let timer;
let score=0;
let index=0;
let usedPool=[];

/* ---------- COMPULSORY QUESTIONS (VERBATIM) ---------- */
const compulsory=[
{
q:`Question 1  
What does July ‚Äì June signify:  
a) Crop year  
b) Financial year  
c) Academic year  

Answer: a  `,
a:["a","crop year"],
intro:"Start sweet: Brownie questions for Sihi huggi bonus points!"
},
{
q:`Question 2  
Pi hide & seek! Spot the pi in the invite   
a) Temple  
b) Stove  
c) Sugarcane   

Answer: b  `,
a:["b","stove"]
},
{
q:`Question 3  
Spot the handsome duo in this flyer?   
(Hint: One cracked equations in dreams, the other is the Father of Indian Mathematics!)  
a) Harish Chandra and Bhaskaracharya  
b) P.C. Mahalanobis and Satyendra Nath Bose  
c) Srinivasa Ramanujan and Aryabhata  

Answer: c  `,
a:["c","ramanujan","aryabhata"]
},
{
q:`Question 4  
What does Sankranti signify astronomically?  
a) Full moon day  
b) Sun‚Äôs transition into Capricorn (Makara Rashi)  
c) Start of winter  
d) Spring equinox  

Answer: b  `,
a:["b","capricorn","makara"]
},
{
q:`Question 5  
Why are kites flown during Sankranti?  
a) For entertainment only  
b) To scare birds away  
c) To mark the monsoon season  
d) To welcome the Sun‚Äôs northward journey (Uttarayan)  

Answer: d  `,
a:["d","uttarayan"]
},
{
q:`Question 6  
Stove ain't apple pieüòÇ, it‚Äôs œÄ‚Ä¶ why?   
a)Nature‚Äôs infinite harvest loop in life‚Äôs eternal abundance circle  
b)Because œÄ represents the number of cashews used in making pongal  

Answer: a  `,
a:["a","infinite"]
},
{
q:`Question 7  
Total Harvest = 750 kg  
Rice constitutes 40% of the total harvest.  
How many kilograms of rice were harvested?  
a) 300 kg  
b) 250 kg  
c) 350 kg  

Answer: a  `,
a:["a","300"]
}
];

/* ---------- HARD QUESTION POOL (35, NON-REPEATING TYPES) ---------- */
const pool=[
{q:"Evaluate log‚ÇÅ‚ÇÄ(1000)",a:["3"]},
{q:"If f(x)=3x‚àí4, find f‚Åª¬π(5)",a:["3"]},
{q:"Simplify: log‚ÇÅ‚ÇÄ(50) ‚àí log‚ÇÅ‚ÇÄ(2)",a:["1.4","1.3979","log25"]},
{q:"If f(x)=x¬≤‚àí1, find f(6)",a:["35"]},
{q:"Ratio 5:7, total land 24 acres. Larger part?",a:["14"]},
{q:"Translate y=x¬≤ up by 3 units.",a:["x^2+3"]},
{q:"If 2x+3y=12, find y when x=3",a:["2"]},
{q:"Evaluate: 2‚Å¥ √ó 2‚Åª¬π",a:["8"]},
{q:"Gradient of y=4x‚àí7",a:["4"]},
{q:"Harvest increases by 20% from 500kg. New harvest?",a:["600"]},
{q:"Solve: x¬≤‚àí9=0 (positive root)",a:["3"]},
{q:"Midpoint of (2,4) and (6,8)",a:["4,6"]},
{q:"Convert 0.375 to fraction",a:["3/8"]},
{q:"Mean of 2,4,6,8",a:["5"]},
{q:"Solve: 3x‚àí7=11",a:["6"]},
{q:"Volume of cube side 4",a:["64"]},
{q:"Simplify: (x¬≤)¬≥",a:["x^6"]},
{q:"Distance between (0,0) and (3,4)",a:["5"]},
{q:"If y‚àùx, y=10 when x=2. Find y when x=6",a:["30"]},
{q:"Solve: log‚ÇÅ‚ÇÄx=1",a:["10"]},
{q:"Slope between (1,2) and (3,6)",a:["2"]},
{q:"Simplify ‚àö144",a:["12"]},
{q:"If f(x)=x‚àí2, find f(f(6))",a:["2"]},
{q:"Area of circle radius 7 (œÄ=22/7)",a:["154"]},
{q:"Solve: 5x=45",a:["9"]},
{q:"Convert 20% to fraction",a:["1/5"]},
{q:"If a:b=4:5 and a=16, find b",a:["20"]},
{q:"Find x: x/4=5",a:["20"]},
{q:"Simplify: 2¬≥+3¬≤",a:["17"]},
{q:"Probability of head in fair coin",a:["1/2"]},
{q:"If f(x)=x¬≥, find f(2)",a:["8"]},
{q:"Mean of first 10 natural numbers",a:["5.5"]}
];

/* ---------- GAME FLOW ---------- */
function startGame(){
  if(!playerName.value.trim()) return;
  startScreen.classList.add("hidden");
  gameScreen.classList.remove("hidden");

  timeSpan.innerText=formatTime(time);
  scoreSpan.innerText=score;

  timer=setInterval(()=>{
    time--;
    timeSpan.innerText=formatTime(time);
    if(time<=0) endGame();
  },1000);

  loadQuestion();
}

function loadQuestion(){
  answerInput.value="";
  introText.innerHTML="";

  if(index < compulsory.length){
    if(index===0) introText.innerHTML="<b>"+compulsory[0].intro+"</b><br><br>";
    show(compulsory[index]);
  }else{
    let q;
    do{
      q=pool[Math.floor(Math.random()*pool.length)];
    }while(usedPool.includes(q.q));
    usedPool.push(q.q);
    show(q);
  }

  skipBtn.classList.toggle("hidden",index<6);
}

function show(q){
  qNo.innerText=`Question ${index+1}`;
  questionText.innerText=q.q;
}

function submitAnswer(){
  const ans=answerInput.value.toLowerCase().trim();
  const current=index<compulsory.length
    ? compulsory[index]
    : pool.find(p=>p.q===questionText.innerText);

  if(current.a.some(a=>ans.includes(a))){
    score+=5;
  }else{
    score-=2;
    if(score<0) score=0;
  }

  scoreSpan.innerText=score;
  index++;
  loadQuestion();
}

function skipQuestion(){
  index++;
  loadQuestion();
}

function endGame(){
  clearInterval(timer);
  localStorage.setItem("pongal_completed","true");
  gameScreen.classList.add("hidden");
  endScreen.classList.remove("hidden");
  finalScore.innerText=score;
}

/* ---------- ELEMENTS ---------- */
const startScreen=document.getElementById("startScreen");
const gameScreen=document.getElementById("gameScreen");
const endScreen=document.getElementById("endScreen");
const qNo=document.getElementById("qNo");
const questionText=document.getElementById("questionText");
const answerInput=document.getElementById("answerInput");
const skipBtn=document.getElementById("skipBtn");
const timeSpan=document.getElementById("time");
const scoreSpan=document.getElementById("score");
const introText=document.getElementById("introText");
const playerName=document.getElementById("playerName");
const finalScore=document.getElementById("finalScore");

timeSpan.innerText=formatTime(time);
</script>

</body>
</html>
