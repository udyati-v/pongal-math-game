<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Sankranti Math Harvest</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  margin: 0;
  font-family: "Segoe UI", Arial, sans-serif;
  background: linear-gradient(#7a0c0c, #c0392b, #f39c12);
  color: #fff;
  overflow-x: hidden;
}

.bg-sun, .bg-cane, .bg-pot {
  position: fixed;
  opacity: 0.25;
  z-index: 0;
}

.bg-sun {
  width: 180px;
  height: 180px;
  background: radial-gradient(circle, #ffd54f, #ff9800);
  border-radius: 50%;
  top: 20px;
  right: -40px;
}

.bg-cane {
  width: 14px;
  height: 260px;
  background: green;
  bottom: 0;
  left: 10px;
}

.bg-pot {
  width: 100px;
  height: 80px;
  background: brown;
  border-radius: 0 0 50px 50px;
  bottom: 10px;
  right: 20px;
}

.card {
  max-width: 540px;
  margin: 70px auto;
  background: rgba(0,0,0,0.65);
  padding: 24px;
  border-radius: 18px;
  z-index: 5;
  position: relative;
}

input {
  width: 100%;
  padding: 12px;
  font-size: 16px;
  border-radius: 8px;
  border: none;
  margin-top: 10px;
}

button {
  width: 100%;
  padding: 14px;
  font-size: 17px;
  border-radius: 10px;
  border: none;
  margin-top: 14px;
  cursor: pointer;
}

.green { background: #27ae60; color: white; }
.orange { background: #e67e22; color: white; }
.disabled { background: #555; cursor: not-allowed; }

.hidden { display: none; }

#questionNumber {
  font-size: 1.1rem;
  font-weight: bold;
  margin-bottom: 10px;
}

#questionText {
  text-align: left;
  line-height: 1.6;
  margin-bottom: 15px;
}

.status {
  display: flex;
  justify-content: space-between;
  font-weight: bold;
  margin-top: 15px;
}
</style>
</head>

<body>

<div class="bg-sun"></div>
<div class="bg-cane"></div>
<div class="bg-pot"></div>

<!-- START PAGE -->
<div class="card" id="startPage">
  <h1>Sankranti Math Harvest üåæ</h1>
  <p>
    Beat the Clock ‚è∞Ô∏è! Solve More ‚ûïÔ∏è score more ‚ú®,<br>
    top 3 wins prizes üèÜ
  </p>
  <input id="playerName" placeholder="Enter your name">
  <button id="startBtn" class="green disabled">Start Game</button>
</div>

<!-- GAME PAGE -->
<div class="card hidden" id="gamePage">
  <div id="questionNumber"></div>
  <div id="questionText"></div>

  <input id="answerInput" placeholder="Type your answer">
  <button class="green" onclick="submitAnswer()">Submit</button>
  <button id="skipBtn" class="orange hidden" onclick="skipQuestion()">Skip</button>

  <div class="status">
    <div>‚è≥ <span id="time">2:30</span></div>
    <div>‚≠ê <span id="score">0</span></div>
  </div>
</div>

<script>
/* ---------- ONE ATTEMPT RULE ---------- */
if (localStorage.getItem("completedGame") === "yes") {
  document.body.innerHTML =
    "<h2 style='text-align:center;margin-top:40vh'>You have already completed the game on this device.</h2>";
}

/* ---------- START PAGE LOGIC ---------- */
const nameInput = document.getElementById("playerName");
const startBtn = document.getElementById("startBtn");

nameInput.addEventListener("input", () => {
  startBtn.classList.toggle("disabled", nameInput.value.trim() === "");
});

startBtn.onclick = () => {
  if (nameInput.value.trim() === "") return;
  document.getElementById("startPage").classList.add("hidden");
  document.getElementById("gamePage").classList.remove("hidden");
  startGame();
};

/* ---------- COMPULSORY QUESTIONS (UNCHANGED) ---------- */
const compulsory = [
{
q:`Start sweet: Brownie questions for Sihi huggi bonus points!

What does July ‚Äì June signify?

a) Crop year
b) Financial year
c) Academic year`,
a:["a","cropyear"]
},
{
q:`Pi hide & seek! Spot the pi in the invite

a) Temple
b) Stove
c) Sugarcane`,
a:["b","stove"]
},
{
q:`Spot the handsome duo in this flyer?
(Hint: One cracked equations in dreams, the other is the Father of Indian Mathematics!)

a) Harish Chandra and Bhaskaracharya
b) P.C. Mahalanobis and Satyendra Nath Bose
c) Srinivasa Ramanujan and Aryabhata`,
a:["c","ramanujan","aryabhata"]
},
{
q:`What does Sankranti signify astronomically?

a) Full moon day
b) Sun‚Äôs transition into Capricorn (Makara Rashi)
c) Start of winter
d) Spring equinox`,
a:["b"]
},
{
q:`Why are kites flown during Sankranti?

a) For entertainment only
b) To scare birds away
c) To mark the monsoon season
d) To welcome the Sun‚Äôs northward journey (Uttarayan)`,
a:["d"]
},
{
q:`Stove ain't apple pie üòÇ, it‚Äôs œÄ‚Ä¶ why?

a) Nature‚Äôs infinite harvest loop in life‚Äôs eternal abundance circle
b) Because œÄ represents the number of cashews used in making pongal`,
a:["a"]
},
{
q:`Total Harvest = 750 kg  
Rice constitutes 40% of the total harvest.

How many kilograms of rice were harvested?

a) 300 kg
b) 250 kg
c) 350 kg`,
a:["a","300"]
}
];

/* ---------- 35-QUESTION MIXED POOL (REAL VARIETY) ---------- */
const pool = [
/* FUNCTIONS */
{ q:`If f(x)=2x‚àí3, find f(5).`, a:["7"] },
{ q:`If f(x)=x¬≤, what is f(‚àí4)?`, a:["16"] },
{ q:`For f(x)=3x+1, find x when f(x)=10.`, a:["3"] },
{ q:`Is f(x)=x¬≤ increasing or decreasing for x>0?`, a:["increasing"] },
{ q:`If f(x)=x+4, what is f(0)?`, a:["4"] },

/* TRANSFORMATIONS */
{ q:`State the vertical shift in y = (x‚àí2)¬≤ + 5.`, a:["up5","5"] },
{ q:`What reflection occurs in y = ‚àíx¬≤?`, a:["xaxis"] },
{ q:`Identify the horizontal shift in y = (x+3)¬≤.`, a:["left3","3"] },
{ q:`What is the stretch factor in y = 2x¬≤?`, a:["2"] },

/* LOGARITHMS */
{ q:`Evaluate log‚ÇÅ‚ÇÄ(100).`, a:["2"] },
{ q:`Evaluate log‚ÇÅ‚ÇÄ(0.01).`, a:["-2"] },
{ q:`Simplify log(10¬≥).`, a:["3"] },
{ q:`Convert log‚ÇÅ‚ÇÄ(1000)=3 to exponential form.`, a:["10^3=1000"] },

/* RATIO & PROPORTION */
{ q:`Divide 60 in the ratio 2:3. Find the larger part.`, a:["36"] },
{ q:`If 5 kg costs ‚Çπ150, what is the cost of 2 kg?`, a:["60"] },
{ q:`If x ‚àù y and x=10 when y=2, find x when y=5.`, a:["25"] },
{ q:`Simplify the ratio 24:36.`, a:["2:3"] },

/* HARVEST / SANKRANTI MATH */
{ q:`A field yields 120 kg per hour. How much in 3 hours?`, a:["360"] },
{ q:`If 25% of 800 kg is pulses, how much pulses?`, a:["200"] },
{ q:`A farmer sells rice at ‚Çπ40/kg. Earnings for 15 kg?`, a:["600"] },
{ q:`If temperature rises from 20¬∞C to 30¬∞C, change?`, a:["10"] },

/* MENTAL MATH */
{ q:`Evaluate: 3¬≤ + 4¬≤.`, a:["25"] },
{ q:`Find 15% of 200.`, a:["30"] },
{ q:`Calculate ‚àö144.`, a:["12"] },
{ q:`What is 2¬≥ √ó 2¬≤?`, a:["32"] },
{ q:`Solve: 100 √∑ 4 + 5.`, a:["30"] }
];

/* ---------- MERGE QUESTIONS ---------- */
const questions = compulsory.concat(
  pool.sort(() => Math.random() - 0.5)
);

/* ---------- GAME STATE ---------- */
let index = 0;
let score = 0;
let timeLeft = 150;
let timer;

/* ---------- GAME FUNCTIONS ---------- */
function startGame(){
  updateStatus();
  showQuestion();
  timer = setInterval(()=>{
    timeLeft--;
    updateStatus();
    if(timeLeft <= 0) endGame();
  },1000);
}

function normalize(x){
  return x.toLowerCase().replace(/[^a-z0-9:+^=.-]/g,"");
}

function showQuestion(){
  document.getElementById("questionNumber").textContent =
    "Question " + (index + 1);

  document.getElementById("questionText").innerHTML =
    questions[index].q.replace(/\n/g,"<br>");

  document.getElementById("skipBtn")
    .classList.toggle("hidden", index < 6);
}

function submitAnswer(){
  const user = normalize(document.getElementById("answerInput").value);
  const correct = questions[index].a.some(ans => normalize(ans) === user);

  if (correct) score += 5;
  else score -= 2;

  nextQuestion();
}

function skipQuestion(){
  nextQuestion();
}

function nextQuestion(){
  document.getElementById("answerInput").value = "";
  index++;
  if (index >= questions.length) endGame();
  else showQuestion();
}

function updateStatus(){
  document.getElementById("score").textContent = score;
  const m = Math.floor(timeLeft/60);
  const s = timeLeft % 60;
  document.getElementById("time").textContent =
    m + ":" + String(s).padStart(2,"0");
}

function endGame(){
  clearInterval(timer);
  localStorage.setItem("completedGame","yes");
  alert("Game Over! Your score: " + score);
}
</script>

</body>
</html>
