<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Sankranti Math Harvest</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  margin: 0;
  font-family: "Segoe UI", Arial, sans-serif;
  background: linear-gradient(#7a0c0c, #c0392b, #f39c12);
  color: #fff;
  overflow-x: hidden;
}

.bg-sun, .bg-cane, .bg-pot {
  position: fixed;
  opacity: 0.25;
  z-index: 0;
}

.bg-sun {
  width: 180px;
  height: 180px;
  background: radial-gradient(circle, #ffd54f, #ff9800);
  border-radius: 50%;
  top: 20px;
  right: -40px;
}

.bg-cane {
  width: 14px;
  height: 260px;
  background: green;
  bottom: 0;
  left: 10px;
}

.bg-pot {
  width: 100px;
  height: 80px;
  background: brown;
  border-radius: 0 0 50px 50px;
  bottom: 10px;
  right: 20px;
}

.card {
  max-width: 540px;
  margin: 70px auto;
  background: rgba(0,0,0,0.65);
  padding: 24px;
  border-radius: 18px;
  z-index: 5;
  position: relative;
}

input {
  width: 100%;
  padding: 12px;
  font-size: 16px;
  border-radius: 8px;
  border: none;
  margin-top: 10px;
}

button {
  width: 100%;
  padding: 14px;
  font-size: 17px;
  border-radius: 10px;
  border: none;
  margin-top: 14px;
  cursor: pointer;
}

.green { background: #27ae60; color: white; }
.orange { background: #e67e22; color: white; }
.disabled { background: #555; cursor: not-allowed; }

.hidden { display: none; }

#questionNumber {
  font-size: 1.1rem;
  font-weight: bold;
  margin-bottom: 10px;
}

#questionText {
  text-align: left;
  line-height: 1.6;
  margin-bottom: 15px;
}

.status {
  display: flex;
  justify-content: space-between;
  font-weight: bold;
  margin-top: 15px;
}

.leader {
  display: flex;
  justify-content: space-between;
  padding: 8px 0;
}
</style>
</head>

<body>

<div class="bg-sun"></div>
<div class="bg-cane"></div>
<div class="bg-pot"></div>

<!-- START PAGE -->
<div class="card" id="startPage">
  <h1>Sankranti Math Harvest üåæ</h1>
  <p>
    Beat the Clock ‚è∞Ô∏è! Solve More ‚ûïÔ∏è score more ‚ú®,<br>
    top 3 wins prizes üèÜ
  </p>
  <input id="playerName" placeholder="Enter your name">
  <button id="startBtn" class="green disabled">Start Game</button>
</div>

<!-- GAME PAGE -->
<div class="card hidden" id="gamePage">
  <div id="questionNumber"></div>
  <div id="questionText"></div>

  <input id="answerInput" placeholder="Type your answer">
  <button class="green" onclick="submitAnswer()">Submit</button>
  <button id="skipBtn" class="orange hidden" onclick="skipQuestion()">Skip</button>

  <div class="status">
    <div>‚è≥ <span id="time">2:30</span></div>
    <div>‚≠ê <span id="score">0</span></div>
  </div>
</div>

<!-- LEADERBOARD PAGE -->
<div class="card hidden" id="leaderboardPage">
  <h2>üèÜ Leaderboard</h2>
  <div id="leaderboard"></div>
</div>

<script>
if (localStorage.getItem("completedGame") === "yes") {
  document.body.innerHTML =
    "<h2 style='text-align:center;margin-top:40vh'>You have already completed the game on this device.</h2>";
}

const nameInput = document.getElementById("playerName");
const startBtn = document.getElementById("startBtn");

nameInput.addEventListener("input", () => {
  startBtn.classList.toggle("disabled", nameInput.value.trim() === "");
});

startBtn.onclick = () => {
  if (!nameInput.value.trim()) return;
  document.getElementById("startPage").classList.add("hidden");
  document.getElementById("gamePage").classList.remove("hidden");
  startGame();
};

/* -------- COMPULSORY QUESTIONS (UNCHANGED) -------- */
const compulsory = [
{
q:`Start sweet: Brownie questions for Sihi huggi bonus points!

What does July ‚Äì June signify?

a) Crop year
b) Financial year
c) Academic year`,
a:["a","cropyear"]
},
{
q:`Pi hide & seek! Spot the pi in the invite

a) Temple
b) Stove
c) Sugarcane`,
a:["b","stove"]
},
{
q:`Spot the handsome duo in this flyer?

a) Harish Chandra and Bhaskaracharya
b) P.C. Mahalanobis and Satyendra Nath Bose
c) Srinivasa Ramanujan and Aryabhata`,
a:["c","ramanujan","aryabhata"]
},
{
q:`What does Sankranti signify astronomically?

a) Full moon day
b) Sun‚Äôs transition into Capricorn
c) Start of winter
d) Spring equinox`,
a:["b"]
},
{
q:`Why are kites flown during Sankranti?

a) Entertainment
b) Scare birds
c) Monsoon
d) Welcome Uttarayan`,
a:["d"]
},
{
q:`Stove ain't apple pie üòÇ, it‚Äôs œÄ‚Ä¶ why?

a) Infinite cycle
b) Cashews`,
a:["a"]
},
{
q:`Total Harvest = 750 kg, Rice = 40%.
How much rice?`,
a:["300","a"]
}
];

/* -------- 35 UNIQUE POOL QUESTIONS -------- */
const pool = [
{q:`If f(x)=3x‚àí1, find f(4).`,a:["11"]},
{q:`If f(x)=x¬≤, what is f(‚àí3)?`,a:["9"]},
{q:`Solve: 2x + 5 = 15.`,a:["5"]},
{q:`Is y=x¬≥ an even or odd function?`,a:["odd"]},
{q:`Find the y-intercept of y=2x+7.`,a:["7"]},

{q:`State the vertical shift in y=(x‚àí1)¬≤‚àí4.`,a:["down4","-4"]},
{q:`What reflection is seen in y=‚àíf(x)?`,a:["xaxis"]},
{q:`Horizontal shift in y=(x+5)¬≤?`,a:["left5","5"]},
{q:`Stretch factor in y=3x¬≤?`,a:["3"]},

{q:`Evaluate log‚ÇÅ‚ÇÄ(1000).`,a:["3"]},
{q:`Evaluate log‚ÇÅ‚ÇÄ(0.001).`,a:["-3"]},
{q:`Solve: log x = 2.`,a:["100"]},

{q:`Simplify the ratio 45:60.`,a:["3:4"]},
{q:`Divide 90 in the ratio 2:1. Larger part?`,a:["60"]},
{q:`If 8 pens cost ‚Çπ40, cost of 1 pen?`,a:["5"]},

{q:`A farmer harvests 150 kg/day. Harvest in 4 days?`,a:["600"]},
{q:`20% of 500 kg is used. How much?`,a:["100"]},
{q:`Price increases from ‚Çπ40 to ‚Çπ50. Increase?`,a:["10"]},

{q:`Find the 5th term of sequence 2,4,6,‚Ä¶`,a:["10"]},
{q:`Sum of first 5 natural numbers?`,a:["15"]},
{q:`Find ‚àö196.`,a:["14"]},
{q:`Evaluate 2¬≥ √ó 4.`,a:["32"]},
{q:`Simplify: 100 √∑ (5√ó4).`,a:["5"]},

{q:`If temperature rises from 18¬∞C to 30¬∞C, change?`,a:["12"]},
{q:`Find 12.5% of 80.`,a:["10"]},
{q:`Solve: 3(x‚àí2)=9.`,a:["5"]},
{q:`Mean of 2,4,6,8?`,a:["5"]},
{q:`If x:y=4:5 and x=20, find y.`,a:["25"]},
{q:`Solve: 7¬≤ ‚àí 3¬≤.`,a:["40"]},
{q:`Evaluate 5! √∑ 4!.`,a:["5"]},
{q:`Simplify 2‚Å¥.`,a:["16"]}
];

const questions = compulsory.concat(pool.sort(()=>Math.random()-0.5));

let index=0,score=0,timeLeft=150,timer,playerName="";

function startGame(){
  playerName=nameInput.value.trim();
  updateStatus();
  showQuestion();
  timer=setInterval(()=>{
    timeLeft--;
    updateStatus();
    if(timeLeft<=0) endGame();
  },1000);
}

function normalize(x){
  return x.toLowerCase().replace(/[^a-z0-9:+^=.-]/g,"");
}

function showQuestion(){
  document.getElementById("questionNumber").textContent="Question "+(index+1);
  document.getElementById("questionText").innerHTML=questions[index].q.replace(/\n/g,"<br>");
  document.getElementById("skipBtn").classList.toggle("hidden",index<6);
}

function submitAnswer(){
  const user=normalize(answerInput.value);
  const correct=questions[index].a.some(ans=>normalize(ans)===user);
  score+=correct?5:-2;
  nextQuestion();
}

function skipQuestion(){nextQuestion();}

function nextQuestion(){
  answerInput.value="";
  index++;
  if(index>=questions.length) endGame();
  else showQuestion();
}

function updateStatus(){
  scoreEl.textContent=score;
  const m=Math.floor(timeLeft/60),s=timeLeft%60;
  timeEl.textContent=m+":"+String(s).padStart(2,"0");
}

function endGame(){
  clearInterval(timer);
  localStorage.setItem("completedGame","yes");
  const scores=JSON.parse(localStorage.getItem("leaderboard")||"[]");
  scores.push({name:playerName,score});
  scores.sort((a,b)=>b.score-a.score);
  localStorage.setItem("leaderboard",JSON.stringify(scores.slice(0,10)));
  gamePage.classList.add("hidden");
  leaderboardPage.classList.remove("hidden");
  leaderboard.innerHTML="";
  scores.slice(0,10).forEach((e,i)=>{
    leaderboard.innerHTML+=
    `<div class="leader">
      <span>${i+1}. ${e.name} ${i<3?["ü•á","ü•à","ü•â"][i]:""}</span>
      <span>${e.score}</span>
    </div>`;
  });
}
</script>
</body>
</html>
