<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Sankranti Math Harvest</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  font-family:"Segoe UI",Arial,sans-serif;
  background:linear-gradient(#7a0c0c,#c0392b,#f39c12);
  color:#fff;
}

.bg-sun,.bg-cane,.bg-pot{
.bg-sun,
.bg-cane,
.bg-pot{
  position:fixed;
  opacity:0.22;
  z-index:0;
  pointer-events:none; /* NEVER block inputs */
}

/* Sun ‚Äî pushed OUTSIDE top-right */
.bg-sun{
  width:160px;
  height:160px;
  background:radial-gradient(circle,#ffd54f,#ff9800);
  border-radius:50%;
  top:-40px;
  right:-70px;
}

/* Sugarcane ‚Äî locked to extreme left */
.bg-cane{
  width:12px;
  height:240px;
  background:linear-gradient(#1e7f34,#3cb371);
  bottom:0;
  left:-25px;
}

/* Pongal pot ‚Äî outside bottom-right */
.bg-pot{
  width:90px;
  height:70px;
  background:#8b4513;
  border-radius:0 0 45px 45px;
  bottom:-20px;
  right:-30px;
}

.card{
  max-width:540px;
  margin:70px auto;
  background:rgba(0,0,0,0.65);
  padding:24px;
  border-radius:18px;
  position:relative;
  z-index:5;
}

input,button{
  width:100%;
  padding:12px;
  margin-top:10px;
  border-radius:8px;
  border:none;
  font-size:16px;
}

.green{background:#27ae60;color:white;}
.orange{background:#e67e22;color:white;}
.disabled{background:#555;cursor:not-allowed;}
.hidden{display:none;}

.status{
  display:flex;
  justify-content:space-between;
  font-weight:bold;
  margin-top:15px;
}

.leader{
  display:flex;
  justify-content:space-between;
  padding:6px 0;
}
</style>
</head>

<body>

<div class="bg-sun"></div>
<div class="bg-cane"></div>
<div class="bg-pot"></div>

<!-- START PAGE -->
<div class="card" id="startPage">
  <h1>Sankranti Math Harvest üåæ</h1>
  <p>
    Beat the Clock ‚è∞Ô∏è! Solve More ‚ûïÔ∏è score more ‚ú®,<br>
    top 3 wins prizes üèÜ
  </p>
  <input id="playerName" placeholder="Enter your name">
  <button id="startBtn" class="green disabled">Start Game</button>
</div>

<!-- GAME PAGE -->
<div class="card hidden" id="gamePage">
  <div id="questionNumber"></div>
  <div id="questionText"></div>

  <input id="answerInput" placeholder="Type your answer">
  <button class="green" id="submitBtn">Submit</button>
  <button class="orange hidden" id="skipBtn">Skip</button>

  <div class="status">
    <div>‚è≥ <span id="time">2:30</span></div>
    <div>‚≠ê <span id="score">0</span></div>
  </div>
</div>

<!-- LEADERBOARD PAGE -->
<div class="card hidden" id="leaderboardPage">
  <h2>üèÜ Leaderboard</h2>
  <div id="leaderboard"></div>
</div>

<script>
/* ---------- DOM ---------- */
const startPage=document.getElementById("startPage");
const gamePage=document.getElementById("gamePage");
const leaderboardPage=document.getElementById("leaderboardPage");
const leaderboard=document.getElementById("leaderboard");

const questionNumber=document.getElementById("questionNumber");
const questionText=document.getElementById("questionText");
const answerInput=document.getElementById("answerInput");
const submitBtn=document.getElementById("submitBtn");
const skipBtn=document.getElementById("skipBtn");

const timeEl=document.getElementById("time");
const scoreEl=document.getElementById("score");

const nameInput=document.getElementById("playerName");
const startBtn=document.getElementById("startBtn");

/* ---------- ONE ATTEMPT RULE ---------- */
if(localStorage.getItem("completedGame")==="yes"){
  document.body.innerHTML="<h2 style='text-align:center;margin-top:40vh'>You have already completed the game on this device.</h2>";
}

/* ---------- START ---------- */
nameInput.addEventListener("input",()=>{
  startBtn.classList.toggle("disabled",!nameInput.value.trim());
});

startBtn.onclick=()=>{
  if(!nameInput.value.trim())return;
  startPage.classList.add("hidden");
  gamePage.classList.remove("hidden");
  startGame();
};

/* ---------- COMPULSORY (EXACT WORDING) ---------- */
const compulsory=[
{
q:`Start sweet: Brownie questions for Sihi huggi bonus points!

What does July ‚Äì June signify:
a) crop year
b) financial year
c) academic year`,
a:["a","cropyear"]
},
{
q:`Pi hide & seek! Spot the pi in the invite
a) Temple
b) Stove
c) Sugarcane`,
a:["b","stove"]
},
{
q:`Spot the handsome duo in this flyer?
(Hint: One cracked equations in dreams, the other is the Father of Indian Mathematics!)
a) Pythagoras and Carl Friedrich Gauss
b) Euler and Archimedes
c) Aryabhata and Srinivasa Ramanujan`,
a:["c","aryabhata","ramanujan"]
},
{
q:`What does Sankranti signify astronomically?
a) Full moon day
b) Sun‚Äôs transition into Capricorn (Makara Rashi)
c) Start of winter
d) Spring equinox`,
a:["b"]
},
{
q:`Why are kites flown during Sankranti?
a) For entertainment only
b) To scare birds away
c) To mark the monsoon season
d) To welcome the Sun‚Äôs northward journey (Uttarayan)`,
a:["d"]
},
{
q:`Stove ain't apple pie üòÇ, it‚Äôs œÄ‚Ä¶ why?
a) Nature‚Äôs infinite harvest loop in life‚Äôs eternal abundance circle
b) Because œÄ represents the number of cashews used in making pongal`,
a:["a"]
},
{
q:`Total Harvest = 750 kg  
Rice constitutes 40% of the total harvest.

How many kilograms of rice were harvested?
a) 300 kg
b) 250 kg
c) 350 kg`,
a:["a","300"]
}
];

/* ---------- 35 POOL QUESTIONS (ALL FILLED) ---------- */
const pool=[
{q:`If f(x)=2x‚àí3, find f(5).`,a:["7"]},
{q:`If f(x)=x¬≤, find f(‚àí4).`,a:["16"]},
{q:`For f(x)=3x+1, find x when f(x)=10.`,a:["3"]},
{q:`Is f(x)=x¬≤ increasing or decreasing for x>0?`,a:["increasing"]},
{q:`Find f(0) for f(x)=x+4.`,a:["4"]},

{q:`State the vertical shift in y=(x‚àí2)¬≤+5.`,a:["up5","5"]},
{q:`What reflection occurs in y=‚àíx¬≤?`,a:["xaxis"]},
{q:`Horizontal shift in y=(x+3)¬≤.`,a:["left3","3"]},
{q:`Stretch factor in y=2x¬≤.`,a:["2"]},

{q:`Evaluate log‚ÇÅ‚ÇÄ(100).`,a:["2"]},
{q:`Evaluate log‚ÇÅ‚ÇÄ(0.01).`,a:["-2"]},
{q:`Simplify log(10¬≥).`,a:["3"]},
{q:`Convert log‚ÇÅ‚ÇÄ(1000)=3 to exponential form.`,a:["10^3=1000"]},

{q:`Divide 60 in the ratio 2:3. Find the larger part.`,a:["36"]},
{q:`If 5 kg costs ‚Çπ150, what is the cost of 2 kg?`,a:["60"]},
{q:`If x ‚àù y and x=10 when y=2, find x when y=5.`,a:["25"]},
{q:`Simplify the ratio 24:36.`,a:["2:3"]},

{q:`A field yields 120 kg per hour. How much in 3 hours?`,a:["360"]},
{q:`If 25% of 800 kg is pulses, how much pulses?`,a:["200"]},
{q:`A farmer sells rice at ‚Çπ40/kg. Earnings for 15 kg?`,a:["600"]},
{q:`Temperature rises from 20¬∞C to 30¬∞C. Change?`,a:["10"]},

{q:`Evaluate 3¬≤ + 4¬≤.`,a:["25"]},
{q:`Find 15% of 200.`,a:["30"]},
{q:`Calculate ‚àö144.`,a:["12"]},
{q:`What is 2¬≥ √ó 2¬≤?`,a:["32"]},
{q:`Solve: 100 √∑ 4 + 5.`,a:["30"]},
{q:`Solve: 3(x‚àí2)=9.`,a:["5"]},
{q:`Mean of 2,4,6,8.`,a:["5"]},
{q:`If x:y=4:5 and x=20, find y.`,a:["25"]},
{q:`Simplify 2‚Å¥.`,a:["16"]},
{q:`Evaluate 5! √∑ 4!.`,a:["5"]},
{q:`Solve 7¬≤ ‚àí 3¬≤.`,a:["40"]}
];

const questions=compulsory.concat(pool.sort(()=>Math.random()-0.5));

/* ---------- GAME LOGIC ---------- */
let index=0,score=0,timeLeft=150,timer,playerName="";

function startGame(){
  playerName=nameInput.value.trim();
  showQuestion();
  updateStatus();
  timer=setInterval(()=>{
    timeLeft--;
    updateStatus();
    if(timeLeft<=0)endGame();
  },1000);
}

function normalize(x){
  return x.toLowerCase().replace(/[^a-z0-9:+^=.-]/g,"");
}

function showQuestion(){
  questionNumber.textContent="Question "+(index+1);
  questionText.innerHTML=questions[index].q.replace(/\n/g,"<br>");
  skipBtn.classList.toggle("hidden",index<6);
}

submitBtn.onclick=()=>{
  if(!answerInput.value.trim())return;
  const user=normalize(answerInput.value);
  const correct=questions[index].a.some(a=>normalize(a)===user);
  score+=correct?5:-2;
  nextQuestion();
};

skipBtn.onclick=()=>nextQuestion();

function nextQuestion(){
  answerInput.value="";
  index++;
  if(index>=questions.length)endGame();
  else showQuestion();
}

function updateStatus(){
  scoreEl.textContent=score;
  const m=Math.floor(timeLeft/60),s=timeLeft%60;
  timeEl.textContent=m+":"+String(s).padStart(2,"0");
}

function endGame(){
  clearInterval(timer);
  localStorage.setItem("completedGame","yes");
  const scores=JSON.parse(localStorage.getItem("leaderboard")||"[]");
  scores.push({name:playerName,score});
  scores.sort((a,b)=>b.score-a.score);
  localStorage.setItem("leaderboard",JSON.stringify(scores.slice(0,10)));

  gamePage.classList.add("hidden");
  leaderboardPage.classList.remove("hidden");
  leaderboard.innerHTML="";
  scores.slice(0,10).forEach((e,i)=>{
    leaderboard.innerHTML+=`
    <div class="leader">
      <span>${i+1}. ${e.name} ${i<3?["ü•á","ü•à","ü•â"][i]:""}</span>
      <span>${e.score}</span>
    </div>`;
  });
}
</script>
</body>
</html>
